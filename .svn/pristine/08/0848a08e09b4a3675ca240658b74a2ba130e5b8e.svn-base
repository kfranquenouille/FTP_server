package test.testrequest;

import static org.junit.Assert.*;

import org.junit.Test;

public class TestLIST extends TestRequest {

	@Test
	public void testLSSuccess() {
		// 220 connection etablished, plz login
		this.client.receiveRequest();
		this.client.sendRequest("USER test");
		// 331 login OK, Password required
		this.client.receiveRequest();		
		// Envoi de la requÃªte USER
		this.client.sendRequest("PASS test");
		// 230 User test logged in
		this.client.receiveRequest();
		// 200 PORT command successful
		int port1 = this.client.socket.getLocalPort() >> 8;
		int port2 = this.client.socket.getLocalPort() & 255;
		this.client.sendRequest("PORT 127,0,0,1,"+ port1 +","+ port2);
		this.client.receiveRequest();
		
		this.client.sendRequest("LIST");
		this.client.receiveRequest();
		this.client.receiveRequest();
		assertEquals("226 Transfer complete", this.client.receiveRequest());
	}

}